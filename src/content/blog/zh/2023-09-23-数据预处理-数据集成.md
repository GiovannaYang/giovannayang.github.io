---
title: 数据预处理-数据集成
tags:
  - data mining
---

**数据集成**：将多个数据源中的数据整合到一个一致的存储中。

**模式集成**：
- 整合不同数据源中的元数据
- 实体识别问题：匹配来自不同数据源的现实世界的实体，比如`A.cust-id=B.customer_no`

**检测并解决数据值的冲突**
- 对现实世界中的同一实体，来自不同数据源的属性值可能是不同的
- 可能的原因：不同的数据表示，不同的度量等等

## 冗余数据

- 集成多个数据库时，经常会出现冗余数据

  - 同一属性在不同的数据库中会有不同的字段名
  - 一个属性可以由另外一个表导出，如“年薪”

- 仔细将多个数据源中的数据集成起来，能够减少或避免结果数据中的冗余与不一致性，从而可以提高挖掘的速度和质量

- 有些冗余可以被相关分析检测到

## 冗余数据处理

### 1. 数值型：相关分析:(correlation /covariance)

#### 相关系数(皮尔逊相关系数)

$$
r_{A,B}=\frac{\sum_{i=1}^{n}(a_i-\bar{A})(b_i-\bar{B})}{(n-1)\sigma _A\sigma _B}=\frac{\sum_{i=1}^{n}(a_ib_i)-n\bar{A}\bar{B}}{(n-1)\sigma_{A}\sigma_{B}}
$$

$n$ 样本个数，$\bar{A}$ 和 $\bar{B}$ 属性A和B上的平均值，$\sigma_{A}$ 和 $\sigma_{B}$ 分别为各自标准差，$\sum(a_ib_i)$ 是AB叉积（cross-product）之和。
 
- $r_{A,B}>0$，正相关（值越大相关程度越高）
- $r_{A,B}=0$，不相关
- $r_{A,B}<0$，负相关（值越小相关程度越高）

#### Covariance(协方差)

衡量两个变量的变化趋势是否一致
 
$$
Cov(A,B)=E((A-\bar{A})(B-\bar{B}))=\frac{\sum_{i=1}^{n}(a_i-\bar{A})(b_i-\bar{B})}{n}
$$

Correlation coefficient: 

$$
r_{A,B}=\frac{Cov(A,B)}{\sigma_{A}\sigma_{B}}
$$

$N$ 样本个数，$\bar{A}$ 和 $\bar{B}$ 属性A和B上的均值，$\sigma_{A}$ 和 $\sigma_{B}$ 分别为各自标准差。

- 协方差为正，则A和B同时倾向于大于期望值
- 协方差为负，则如果A大于其期望值，B更倾向于小于其期望值

### 2. 标称数据：卡方检验 ( χ2(chi-square) test )

![](/img/posts/zh/2023-09-23/020801.png)

- $\sigma_{ij}$ 是 $(a_i,b_j)$ 的观测频度（实际计数）
  
- $e_{ij}$ 是 $(a_i,b_j)$ 的期望频度

- $N$ 数据元组的个数

$$
\chi^{2}=\sum_{i=1}^{c}\sum_{j=1}^{r}\frac{(\sigma_{ij}-e_{ij})^2}{e_{ij}}
$$

$$
e_{ij}=\frac{count(A=a_i)*count(B=b_j)}{N}
$$

自由度：$(c-1)*(r-1)$
